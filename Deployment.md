#代码部署相关

##git分支

- 开发阶段只存在master分支，所有开发都可以在此进行（个人本地可以建分支开发）。
- 项目上线后，增加dev分支，master保持稳定。开发测试在dev分支进行，确认无误后merge到master。如果有hotfix可以直接修改master。推荐开发都在本地创建分支开发。
- 每次ci时请大概说明这次提交做了什么事情。
- 本地独立分支开发，如果ci次数较多，在最后merge到主分支时，请使用--squash，保持log干净。

##代码上线

由上线脚本执行，上线脚本顺序执行这几件事情:

- master分支merge dev上的代码。
- 服务器pull最新的master代码。
- 服务器跑grunt任务，包括压缩JS、压缩CSS、压缩图片、为图片添加版本号并替换代码中响应请求的URL。
- 重启服务。

_其中第三步是在本地执行还是上线脚本中执行，需要考虑_

##代码回滚

可以采用个人revert然后上线，也可以在服务器执行回滚，可以大家商量一下。

##错误收集

- php错误通过log查看，写个tail -f的脚本供使用。
- JS错误通过JS代码改写window.onerror来发回log。

##性能检测

我用phantom来抓，可以每天定时自动发邮件出对比，也可提供展示平台。

